---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "_notebooks/SmilesLMFastai.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/SmilesLMFastai.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.text</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="n">bs</span> <span class="o">=</span> <span class="mi">32</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/media/loschen/NEWDATA/data/molecule_images&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;molecule_images.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(133247, 13)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">,</span><span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">|</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">))]</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>inchikey</th>
      <th>SMILES</th>
      <th>NumAliphaticRings</th>
      <th>CalcNumAromaticRings</th>
      <th>CalcNumBridgeheadAtoms</th>
      <th>CalcNumRotatableBonds</th>
      <th>CalcNumHBA</th>
      <th>CalcNumHBD</th>
      <th>CalcNumRings</th>
      <th>MolLogP</th>
      <th>GetFormalCharge</th>
      <th>MolMR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>VNWKTOKETHGBQD-UHFFFAOYSA-N</td>
      <td>C</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.63610</td>
      <td>0</td>
      <td>6.7310</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>QGZKDVFQNNGYKY-UHFFFAOYSA-N</td>
      <td>N</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0.16200</td>
      <td>0</td>
      <td>5.0221</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>XLYOFNOQVPJJNP-UHFFFAOYSA-N</td>
      <td>O</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-0.82470</td>
      <td>0</td>
      <td>3.6138</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>HSFWRNGVRCDJHI-UHFFFAOYSA-N</td>
      <td>C#C</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.24940</td>
      <td>0</td>
      <td>9.8900</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>LELOWRISYMNNSU-UHFFFAOYSA-N</td>
      <td>C#N</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0.13978</td>
      <td>0</td>
      <td>6.6700</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>133233</th>
      <td>133233</td>
      <td>LPNIJQZZJAITJM-UHFFFAOYSA-N</td>
      <td>C1C2CC3C4CC3(O2)C14</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>1.18370</td>
      <td>0</td>
      <td>31.9250</td>
    </tr>
    <tr>
      <th>133234</th>
      <td>133234</td>
      <td>BXTBRKSXZFAABS-UHFFFAOYSA-N</td>
      <td>C1C2OC3C4CC3(O2)C14</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>5</td>
      <td>0.52010</td>
      <td>0</td>
      <td>28.6910</td>
    </tr>
    <tr>
      <th>133235</th>
      <td>133235</td>
      <td>BGOAASCIAIBBKN-UHFFFAOYSA-N</td>
      <td>C1C2OC3C4CC13C4O2</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>5</td>
      <td>0.52010</td>
      <td>0</td>
      <td>28.6910</td>
    </tr>
    <tr>
      <th>133240</th>
      <td>133240</td>
      <td>IBUPBUYMKIPOKE-UHFFFAOYSA-N</td>
      <td>C1C2C3C2C2C4CC12C43</td>
      <td>8</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>1.51820</td>
      <td>0</td>
      <td>32.6070</td>
    </tr>
    <tr>
      <th>133243</th>
      <td>133243</td>
      <td>BUJMZWLEDKTAQK-UHFFFAOYSA-N</td>
      <td>C1C2C3C4C5OC13C2C54</td>
      <td>8</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>8</td>
      <td>0.64950</td>
      <td>0</td>
      <td>29.6710</td>
    </tr>
  </tbody>
</table>
<p>104306 rows × 13 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smi_vocab</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">SMILES</span><span class="p">))))</span><span class="o">+</span><span class="p">[</span><span class="n">BOS</span><span class="p">,</span><span class="n">EOS</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">smi_vocab</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;/&#39;, &#39;(&#39;, &#39;\\&#39;, &#39;H&#39;, &#39;)&#39;, &#39;5&#39;, &#39;[&#39;, &#39;n&#39;, &#39;F&#39;, &#39;2&#39;, &#39;=&#39;, &#39;c&#39;, &#39;4&#39;, &#39;C&#39;, &#39;#&#39;, &#39;1&#39;, &#39;3&#39;, &#39;o&#39;, &#39;N&#39;, &#39;.&#39;, &#39;]&#39;, &#39;O&#39;, &#39;xxbos&#39;, &#39;xxeos&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SmilesTokenizer</span><span class="p">(</span><span class="n">BaseTokenizer</span><span class="p">):</span>
    <span class="s2">&quot;Tokenize Smiles.&quot;</span>
    <span class="k">def</span> <span class="nf">tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="c1">#print(&quot;t: {:s}&quot;.format(t))</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39; &#39;</span><span class="p">:</span> 
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">BOS</span><span class="p">):</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BOS</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">BOS</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">EOS</span><span class="p">):</span>
            <span class="c1">#    res.append(EOS)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">EOS</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#print(res)</span>
        <span class="k">return</span> <span class="n">res</span>
    <span class="k">def</span> <span class="nf">add_special_cases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">toks</span><span class="p">:</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span> <span class="k">pass</span>
    
<span class="n">sm</span> <span class="o">=</span> <span class="n">SmilesTokenizer</span><span class="p">(</span><span class="s1">&#39;smiles&#39;</span><span class="p">)</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span><span class="n">BOS</span><span class="o">+</span><span class="s1">&#39; ccX&#39;</span><span class="o">+</span><span class="n">EOS</span><span class="p">)</span>
<span class="n">tokens</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;xxbos&#39;, &#39;c&#39;, &#39;c&#39;, &#39;X&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#vocab=Vocab(itos)</span>
<span class="n">tokenizer</span><span class="o">=</span><span class="n">Tokenizer</span><span class="p">(</span><span class="n">SmilesTokenizer</span><span class="p">,</span> <span class="n">pre_rules</span><span class="o">=</span><span class="p">[],</span> <span class="n">post_rules</span><span class="o">=</span><span class="p">[])</span>
<span class="n">tp</span> <span class="o">=</span> <span class="n">TokenizeProcessor</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">,</span><span class="n">include_bos</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_eos</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mark_fields</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">np</span> <span class="o">=</span> <span class="n">NumericalizeProcessor</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">Vocab</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">smi_vocab</span><span class="p">,</span> <span class="n">max_vocab</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">min_freq</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">np</span> <span class="o">=</span> <span class="n">NumericalizeProcessor</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">Vocab</span><span class="p">(</span><span class="n">smi_vocab</span><span class="p">))</span>
<span class="n">processors</span> <span class="o">=</span> <span class="p">[</span><span class="n">tp</span><span class="p">,</span><span class="n">np</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tl</span> <span class="o">=</span> <span class="n">TextList</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">processor</span><span class="o">=</span><span class="n">processors</span><span class="p">)</span>
<span class="n">tl</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>TextList (104306 items)
C,N,O,C#C,C#N
Path: /media/loschen/NEWDATA/data/molecule_images</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Language-model">Language model<a class="anchor-link" href="#Language-model"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">split_by_rand_pct</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">label_for_lm</span><span class="p">()</span><span class="o">.</span><span class="n">databunch</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>TextLMDataBunch;

Train: LabelList (93876 items)
x: LMTextList
xxbos C,xxbos O,xxbos C # C,xxbos C # N,xxbos C C
y: LMLabelList
,,,,
Path: /media/loschen/NEWDATA/data/molecule_images;

Valid: LabelList (10430 items)
x: LMTextList
xxbos C O C C 1 ( N ) C N C 1 = O,xxbos O = C 1 C C C 2 C C 2 C N 1,xxbos C C # C c 1 o n c c 1 N,xxbos C C ( O ) C 1 C 2 C C ( = O ) N 2 1,xxbos C C ( C # N ) C 1 ( O ) C C C 1
y: LMLabelList
,,,,
Path: /media/loschen/NEWDATA/data/molecule_images;

Test: None</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Regression-model">Regression model<a class="anchor-link" href="#Regression-model"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">labels_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CalcNumRings&#39;</span><span class="p">,</span><span class="s1">&#39;CalcNumRotatableBonds&#39;</span><span class="p">]</span>
<span class="c1">#labels_cols = [&#39;MolLogP&#39;,&#39;MolMR&#39;]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">split_by_rand_pct</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">label_from_df</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="n">labels_cols</span><span class="p">,</span><span class="n">label_cls</span><span class="o">=</span><span class="n">FloatList</span><span class="p">)</span><span class="o">.</span><span class="n">databunch</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>fastai.text.data.TextClasDataBunch</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doc</span><span class="p">(</span><span class="n">TextClasDataBunch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>idx</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>C ) = O xxbos C C ( = O ) C # N xxbos N # C C ( = N ) N xxbos C # C C ( N ) = O xxbos N = C ( N ) C = O xxbos N C ( = O ) C = O xxbos C # C C ( C ) C xxbos C C ( C )</td>
    </tr>
    <tr>
      <td>1</td>
      <td>N ) n 1 xxbos C C c 1 c o c ( O ) n 1 xxbos C N c 1 c [ n H ] c ( C ) n 1 xxbos C N c 1 c [ n H ] c ( N ) c 1 xxbos C N c 1 c [ n H ] c ( O ) c 1 xxbos C N c 1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>xxbos C C ( C # N ) C C C # N xxbos C # C C N C ( C ) C # N xxbos C # C C ( C ) N C C # N xxbos C C ( C # N ) N C C # N xxbos C # C C O C ( C ) C # C xxbos C # C C</td>
    </tr>
    <tr>
      <td>3</td>
      <td>C C 1 C O C O 1 xxbos N # C C C 1 O C C O 1 xxbos O = C C C 1 = C C C C 1 xxbos O = C C C 1 = C C O C 1 xxbos O = C C C 1 = N C C O 1 xxbos O = C N C 1 = C C C</td>
    </tr>
    <tr>
      <td>4</td>
      <td>C 2 O C C 2 C O 1 xxbos C 1 C C 2 C O C 2 C O 1 xxbos C 1 O C C 2 O C C 2 O 1 xxbos C # C C C 1 C 2 C C C 1 2 xxbos C # C C C 1 C 2 C O C 1 2 xxbos N # C C C 1</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">valid_ds</span><span class="o">.</span><span class="n">vocab</span>
<span class="n">v</span><span class="o">.</span><span class="n">itos</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;/&#39;,
 &#39;(&#39;,
 &#39;\\&#39;,
 &#39;H&#39;,
 &#39;)&#39;,
 &#39;5&#39;,
 &#39;[&#39;,
 &#39;n&#39;,
 &#39;F&#39;,
 &#39;2&#39;,
 &#39;=&#39;,
 &#39;c&#39;,
 &#39;4&#39;,
 &#39;C&#39;,
 &#39;#&#39;,
 &#39;1&#39;,
 &#39;3&#39;,
 &#39;o&#39;,
 &#39;N&#39;,
 &#39;.&#39;,
 &#39;]&#39;,
 &#39;O&#39;,
 &#39;xxbos&#39;,
 &#39;xxeos&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">train_dl</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>x is 2D and of shape (batch_size, max_seq_length), as embedding is done later</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([32, 28])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">train_ds</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">textify</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;/&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">train_ds</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">textify</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;( ( ( ( ( ( xxbos C C 1 2 C ( O ) C 3 ( O ) C 1 4 O C 2 3 4&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">v</span><span class="o">.</span><span class="n">textify</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;((((((xxbosCC12C(O)C3(O)C14OC234&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">example</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="mi">10</span><span class="p">,:]</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
<span class="n">texts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">data</span><span class="o">.</span><span class="n">train_ds</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">textify</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">example</span><span class="p">])</span>
<span class="n">texts</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
      <th>26</th>
      <th>27</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>xxbos</td>
      <td>O</td>
      <td>=</td>
      <td>c</td>
      <td>1</td>
      <td>[</td>
      <td>n</td>
      <td>H</td>
      <td>]</td>
      <td>c</td>
      <td>...</td>
      <td>c</td>
      <td>(</td>
      <td>=</td>
      <td>O</td>
      <td>)</td>
      <td>[</td>
      <td>n</td>
      <td>H</td>
      <td>]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>xxbos</td>
      <td>C</td>
      <td>C</td>
      <td>1</td>
      <td>...</td>
      <td>O</td>
      <td>)</td>
      <td>C</td>
      <td>1</td>
      <td>4</td>
      <td>O</td>
      <td>C</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>xxbos</td>
      <td>N</td>
      <td>c</td>
      <td>...</td>
      <td>c</td>
      <td>(</td>
      <td>=</td>
      <td>O</td>
      <td>)</td>
      <td>[</td>
      <td>n</td>
      <td>H</td>
      <td>]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>xxbos</td>
      <td>C</td>
      <td>C</td>
      <td>...</td>
      <td>)</td>
      <td>C</td>
      <td>2</td>
      <td>(</td>
      <td>C</td>
      <td>)</td>
      <td>N</td>
      <td>C</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>xxbos</td>
      <td>C</td>
      <td>C</td>
      <td>...</td>
      <td>C</td>
      <td>(</td>
      <td>C</td>
      <td>1</td>
      <td>=</td>
      <td>O</td>
      <td>)</td>
      <td>C</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>xxbos</td>
      <td>C</td>
      <td>#</td>
      <td>...</td>
      <td>C</td>
      <td>3</td>
      <td>4</td>
      <td>O</td>
      <td>C</td>
      <td>2</td>
      <td>3</td>
      <td>C</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>xxbos</td>
      <td>C</td>
      <td>C</td>
      <td>...</td>
      <td>C</td>
      <td>(</td>
      <td>=</td>
      <td>O</td>
      <td>)</td>
      <td>C</td>
      <td>1</td>
      <td>C</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>xxbos</td>
      <td>O</td>
      <td>...</td>
      <td>)</td>
      <td>c</td>
      <td>(</td>
      <td>O</td>
      <td>)</td>
      <td>[</td>
      <td>n</td>
      <td>H</td>
      <td>]</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>xxbos</td>
      <td>O</td>
      <td>...</td>
      <td>C</td>
      <td>2</td>
      <td>C</td>
      <td>3</td>
      <td>C</td>
      <td>C</td>
      <td>1</td>
      <td>C</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>(</td>
      <td>xxbos</td>
      <td>C</td>
      <td>...</td>
      <td>C</td>
      <td>1</td>
      <td>(</td>
      <td>C</td>
      <td>C</td>
      <td>1</td>
      <td>)</td>
      <td>C</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 28 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nv</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">itos</span><span class="p">);</span> <span class="n">nv</span>
<span class="n">nh</span><span class="o">=</span><span class="mi">64</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SmilesModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i_h</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">nv</span><span class="p">,</span><span class="n">nh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rnn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">GRU</span><span class="p">(</span><span class="n">nh</span><span class="p">,</span> <span class="n">nh</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">batch_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_o</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">nh</span><span class="p">,</span><span class="n">nv</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bn</span> <span class="o">=</span> <span class="n">BatchNorm1dFlat</span><span class="p">(</span><span class="n">nh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">nh</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">res</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rnn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i_h</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_o</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>TextLMDataBunch;

Train: LabelList (93876 items)
x: LMTextList
xxbos C,xxbos N,xxbos C # C,xxbos C = O,xxbos C C
y: LMLabelList
,,,,
Path: /media/loschen/NEWDATA/data/molecule_images;

Valid: LabelList (10430 items)
x: LMTextList
xxbos C C ( O ) C 1 ( C ) C C = C C 1,xxbos C C 1 2 C C C ( C 1 = O ) C 2 O,xxbos C C C 1 C = C ( C ) C 2 N C 1 2,xxbos N C ( = O ) O c 1 c o c n 1,xxbos C C 1 C C N 1 C ( = O ) C = O
y: LMLabelList
,,,,
Path: /media/loschen/NEWDATA/data/molecule_images;

Test: None</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#learn = Learner(data, Model(), metrics=accuracy)</span>
<span class="c1">#learn = text_classifier_learner(data, AWD_LSTM, drop_mult=0.5, pretrained=False,metrics=[rmse])</span>
<span class="c1">#learn = learn.to_fp16(clip=0.1)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">language_model_learner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">AWD_LSTM</span><span class="p">)</span>
<span class="c1">#learn = language_model_learner(data, AWD_LSTM,drop_mult=0.5,pretrained=False)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-230-a4deb9a6bb1c&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-red-fg">#learn = text_classifier_learner(data, AWD_LSTM, drop_mult=0.5, pretrained=False,metrics=[rmse])</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span class="ansi-red-fg">#learn = learn.to_fp16(clip=0.1)</span>
<span class="ansi-green-fg">----&gt; 5</span><span class="ansi-red-fg"> </span>learn <span class="ansi-blue-fg">=</span> language_model_learner<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">,</span> AWD_LSTM<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> <span class="ansi-red-fg">#learn = language_model_learner(data, AWD_LSTM,drop_mult=0.5,pretrained=False)</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span> learn<span class="ansi-blue-fg">.</span>summary<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/miniconda3/envs/schnetpack+fastai/lib/python3.6/site-packages/fastai/text/learner.py</span> in <span class="ansi-cyan-fg">language_model_learner</span><span class="ansi-blue-fg">(data, arch, config, drop_mult, pretrained, pretrained_fnames, **learn_kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    207</span>     meta <span class="ansi-blue-fg">=</span> _model_meta<span class="ansi-blue-fg">[</span>arch<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    208</span>     learn <span class="ansi-blue-fg">=</span> LanguageLearner<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">,</span> model<span class="ansi-blue-fg">,</span> split_func<span class="ansi-blue-fg">=</span>meta<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;split_lm&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>learn_kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 209</span><span class="ansi-red-fg">     </span>url <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#39;url_bwd&#39;</span> <span class="ansi-green-fg">if</span> data<span class="ansi-blue-fg">.</span>backwards <span class="ansi-green-fg">else</span> <span class="ansi-blue-fg">&#39;url&#39;</span>
<span class="ansi-green-intense-fg ansi-bold">    210</span>     <span class="ansi-green-fg">if</span> pretrained <span class="ansi-green-fg">or</span> pretrained_fnames<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    211</span>         <span class="ansi-green-fg">if</span> pretrained_fnames <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/miniconda3/envs/schnetpack+fastai/lib/python3.6/site-packages/fastai/basic_data.py</span> in <span class="ansi-cyan-fg">__getattr__</span><span class="ansi-blue-fg">(self, k)</span>
<span class="ansi-green-intense-fg ansi-bold">    120</span>         <span class="ansi-green-fg">return</span> cls<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>dls<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">=</span>path<span class="ansi-blue-fg">,</span> device<span class="ansi-blue-fg">=</span>device<span class="ansi-blue-fg">,</span> dl_tfms<span class="ansi-blue-fg">=</span>dl_tfms<span class="ansi-blue-fg">,</span> collate_fn<span class="ansi-blue-fg">=</span>collate_fn<span class="ansi-blue-fg">,</span> no_check<span class="ansi-blue-fg">=</span>no_check<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    121</span> 
<span class="ansi-green-fg">--&gt; 122</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> __getattr__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>k<span class="ansi-blue-fg">:</span>int<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">-&gt;</span>Any<span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> getattr<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>train_dl<span class="ansi-blue-fg">,</span> k<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    123</span>     <span class="ansi-green-fg">def</span> __setstate__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>data<span class="ansi-blue-fg">:</span>Any<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>__dict__<span class="ansi-blue-fg">.</span>update<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    124</span> 

<span class="ansi-green-fg">~/miniconda3/envs/schnetpack+fastai/lib/python3.6/site-packages/fastai/basic_data.py</span> in <span class="ansi-cyan-fg">__getattr__</span><span class="ansi-blue-fg">(self, k)</span>
<span class="ansi-green-intense-fg ansi-bold">     36</span> 
<span class="ansi-green-intense-fg ansi-bold">     37</span>     <span class="ansi-green-fg">def</span> __len__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">-&gt;</span>int<span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 38</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> __getattr__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>k<span class="ansi-blue-fg">:</span>str<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">-&gt;</span>Any<span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> getattr<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">,</span> k<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     39</span>     <span class="ansi-green-fg">def</span> __setstate__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>data<span class="ansi-blue-fg">:</span>Any<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>__dict__<span class="ansi-blue-fg">.</span>update<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     40</span> 

<span class="ansi-green-fg">~/miniconda3/envs/schnetpack+fastai/lib/python3.6/site-packages/fastai/basic_data.py</span> in <span class="ansi-cyan-fg">DataLoader___getattr__</span><span class="ansi-blue-fg">(dl, k)</span>
<span class="ansi-green-intense-fg ansi-bold">     18</span> torch<span class="ansi-blue-fg">.</span>utils<span class="ansi-blue-fg">.</span>data<span class="ansi-blue-fg">.</span>DataLoader<span class="ansi-blue-fg">.</span>__init__ <span class="ansi-blue-fg">=</span> intercept_args
<span class="ansi-green-intense-fg ansi-bold">     19</span> 
<span class="ansi-green-fg">---&gt; 20</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">def</span> DataLoader___getattr__<span class="ansi-blue-fg">(</span>dl<span class="ansi-blue-fg">,</span> k<span class="ansi-blue-fg">:</span>str<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">-&gt;</span>Any<span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> getattr<span class="ansi-blue-fg">(</span>dl<span class="ansi-blue-fg">.</span>dataset<span class="ansi-blue-fg">,</span> k<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     21</span> DataLoader<span class="ansi-blue-fg">.</span>__getattr__ <span class="ansi-blue-fg">=</span> DataLoader___getattr__
<span class="ansi-green-intense-fg ansi-bold">     22</span> 

<span class="ansi-green-fg">~/miniconda3/envs/schnetpack+fastai/lib/python3.6/site-packages/fastai/data_block.py</span> in <span class="ansi-cyan-fg">__getattr__</span><span class="ansi-blue-fg">(self, k)</span>
<span class="ansi-green-intense-fg ansi-bold">    641</span>         res <span class="ansi-blue-fg">=</span> getattr<span class="ansi-blue-fg">(</span>y<span class="ansi-blue-fg">,</span> k<span class="ansi-blue-fg">,</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    642</span>         <span class="ansi-green-fg">if</span> res <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> res
<span class="ansi-green-fg">--&gt; 643</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">raise</span> AttributeError<span class="ansi-blue-fg">(</span>k<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    644</span> 
<span class="ansi-green-intense-fg ansi-bold">    645</span>     <span class="ansi-green-fg">def</span> __setstate__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>data<span class="ansi-blue-fg">:</span>Any<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>__dict__<span class="ansi-blue-fg">.</span>update<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">AttributeError</span>: backwards</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://medium.com/mlreview/understanding-building-blocks-of-ulmfit-818d3775325b">https://medium.com/mlreview/understanding-building-blocks-of-ulmfit-818d3775325b</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SequentialRNN(
  (0): AWD_LSTM(
    (encoder): Embedding(24, 400, padding_idx=1)
    (encoder_dp): EmbeddingDropout(
      (emb): Embedding(24, 400, padding_idx=1)
    )
    (rnns): ModuleList(
      (0): WeightDropout(
        (module): LSTM(400, 1152, batch_first=True)
      )
      (1): WeightDropout(
        (module): LSTM(1152, 1152, batch_first=True)
      )
      (2): WeightDropout(
        (module): LSTM(1152, 400, batch_first=True)
      )
    )
    (input_dp): RNNDropout()
    (hidden_dps): ModuleList(
      (0): RNNDropout()
      (1): RNNDropout()
      (2): RNNDropout()
    )
  )
  (1): LinearDecoder(
    (decoder): Linear(in_features=400, out_features=24, bias=True)
    (output_dp): RNNDropout()
  )
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SequentialRNN(
  (0): MultiBatchEncoder(
    (module): AWD_LSTM(
      (encoder): Embedding(24, 400, padding_idx=1)
      (encoder_dp): EmbeddingDropout(
        (emb): Embedding(24, 400, padding_idx=1)
      )
      (rnns): ModuleList(
        (0): WeightDropout(
          (module): LSTM(400, 1152, batch_first=True)
        )
        (1): WeightDropout(
          (module): LSTM(1152, 1152, batch_first=True)
        )
        (2): WeightDropout(
          (module): LSTM(1152, 400, batch_first=True)
        )
      )
      (input_dp): RNNDropout()
      (hidden_dps): ModuleList(
        (0): RNNDropout()
        (1): RNNDropout()
        (2): RNNDropout()
      )
    )
  )
  (1): PoolingLinearClassifier(
    (layers): Sequential(
      (0): BatchNorm1d(1200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): Dropout(p=0.2, inplace=False)
      (2): Linear(in_features=1200, out_features=50, bias=True)
      (3): ReLU(inplace=True)
      (4): BatchNorm1d(50, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (5): Dropout(p=0.1, inplace=False)
      (6): Linear(in_features=50, out_features=2, bias=True)
    )
  )
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='0' class='' max='1' style='width:300px; height:20px; vertical-align: middle;'></progress>
      0.00% [0/1 00:00<00:00]
    </div>
    
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table><p>

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='99' class='' max='664' style='width:300px; height:20px; vertical-align: middle;'></progress>
      14.91% [99/664 00:07<00:42 5.6842]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>LR Finder is complete, type {learner_name}.recorder.plot() to see the graph.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.538173</td>
      <td>1.259675</td>
      <td>0.568394</td>
      <td>00:51</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.442617</td>
      <td>1.227715</td>
      <td>0.567302</td>
      <td>00:51</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.368289</td>
      <td>1.170785</td>
      <td>0.589907</td>
      <td>00:51</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;smiles_lm&#39;</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">save_encoder</span><span class="p">(</span><span class="s1">&#39;smiles_ln_encoder&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;smiles_lm&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-232-82e716187ae9&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>learn<span class="ansi-blue-fg">.</span>load<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;smiles_lm&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/miniconda3/envs/schnetpack+fastai/lib/python3.6/site-packages/fastai/basic_train.py</span> in <span class="ansi-cyan-fg">load</span><span class="ansi-blue-fg">(self, file, device, strict, with_opt, purge, remove_module)</span>
<span class="ansi-green-intense-fg ansi-bold">    271</span>             model_state <span class="ansi-blue-fg">=</span> state<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;model&#39;</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    272</span>             <span class="ansi-green-fg">if</span> remove_module<span class="ansi-blue-fg">:</span> model_state <span class="ansi-blue-fg">=</span> remove_module_load<span class="ansi-blue-fg">(</span>model_state<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 273</span><span class="ansi-red-fg">             </span>get_model<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>load_state_dict<span class="ansi-blue-fg">(</span>model_state<span class="ansi-blue-fg">,</span> strict<span class="ansi-blue-fg">=</span>strict<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    274</span>             <span class="ansi-green-fg">if</span> ifnone<span class="ansi-blue-fg">(</span>with_opt<span class="ansi-blue-fg">,</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    275</span>                 <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> hasattr<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;opt&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>create_opt<span class="ansi-blue-fg">(</span>defaults<span class="ansi-blue-fg">.</span>lr<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>wd<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/miniconda3/envs/schnetpack+fastai/lib/python3.6/site-packages/torch/nn/modules/module.py</span> in <span class="ansi-cyan-fg">load_state_dict</span><span class="ansi-blue-fg">(self, state_dict, strict)</span>
<span class="ansi-green-intense-fg ansi-bold">    828</span>         <span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>error_msgs<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&gt;</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    829</span>             raise RuntimeError(&#39;Error(s) in loading state_dict for {}:\n\t{}&#39;.format(
<span class="ansi-green-fg">--&gt; 830</span><span class="ansi-red-fg">                                self.__class__.__name__, &#34;\n\t&#34;.join(error_msgs)))
</span><span class="ansi-green-intense-fg ansi-bold">    831</span>         <span class="ansi-green-fg">return</span> _IncompatibleKeys<span class="ansi-blue-fg">(</span>missing_keys<span class="ansi-blue-fg">,</span> unexpected_keys<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    832</span> 

<span class="ansi-red-fg">RuntimeError</span>: Error(s) in loading state_dict for SequentialRNN:
	Missing key(s) in state_dict: &#34;0.module.encoder.weight&#34;, &#34;0.module.encoder_dp.emb.weight&#34;, &#34;0.module.rnns.0.weight_hh_l0_raw&#34;, &#34;0.module.rnns.0.module.weight_ih_l0&#34;, &#34;0.module.rnns.0.module.weight_hh_l0&#34;, &#34;0.module.rnns.0.module.bias_ih_l0&#34;, &#34;0.module.rnns.0.module.bias_hh_l0&#34;, &#34;0.module.rnns.1.weight_hh_l0_raw&#34;, &#34;0.module.rnns.1.module.weight_ih_l0&#34;, &#34;0.module.rnns.1.module.weight_hh_l0&#34;, &#34;0.module.rnns.1.module.bias_ih_l0&#34;, &#34;0.module.rnns.1.module.bias_hh_l0&#34;, &#34;0.module.rnns.2.weight_hh_l0_raw&#34;, &#34;0.module.rnns.2.module.weight_ih_l0&#34;, &#34;0.module.rnns.2.module.weight_hh_l0&#34;, &#34;0.module.rnns.2.module.bias_ih_l0&#34;, &#34;0.module.rnns.2.module.bias_hh_l0&#34;, &#34;1.layers.0.weight&#34;, &#34;1.layers.0.bias&#34;, &#34;1.layers.0.running_mean&#34;, &#34;1.layers.0.running_var&#34;, &#34;1.layers.2.weight&#34;, &#34;1.layers.2.bias&#34;, &#34;1.layers.4.weight&#34;, &#34;1.layers.4.bias&#34;, &#34;1.layers.4.running_mean&#34;, &#34;1.layers.4.running_var&#34;, &#34;1.layers.6.weight&#34;, &#34;1.layers.6.bias&#34;. 
	Unexpected key(s) in state_dict: &#34;0.encoder.weight&#34;, &#34;0.encoder_dp.emb.weight&#34;, &#34;0.rnns.0.weight_hh_l0_raw&#34;, &#34;0.rnns.0.module.weight_ih_l0&#34;, &#34;0.rnns.0.module.weight_hh_l0&#34;, &#34;0.rnns.0.module.bias_ih_l0&#34;, &#34;0.rnns.0.module.bias_hh_l0&#34;, &#34;0.rnns.1.weight_hh_l0_raw&#34;, &#34;0.rnns.1.module.weight_ih_l0&#34;, &#34;0.rnns.1.module.weight_hh_l0&#34;, &#34;0.rnns.1.module.bias_ih_l0&#34;, &#34;0.rnns.1.module.bias_hh_l0&#34;, &#34;0.rnns.2.weight_hh_l0_raw&#34;, &#34;0.rnns.2.module.weight_ih_l0&#34;, &#34;0.rnns.2.module.weight_hh_l0&#34;, &#34;0.rnns.2.module.bias_ih_l0&#34;, &#34;0.rnns.2.module.bias_hh_l0&#34;, &#34;1.decoder.weight&#34;, &#34;1.decoder.bias&#34;. </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="n">n_words</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-227-61383812ae2f&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>learn<span class="ansi-blue-fg">.</span>predict<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;CC&#39;</span><span class="ansi-blue-fg">,</span> n_words<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">20</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/miniconda3/envs/schnetpack+fastai/lib/python3.6/site-packages/fastai/basic_train.py</span> in <span class="ansi-cyan-fg">predict</span><span class="ansi-blue-fg">(self, item, return_x, batch_first, with_dropout, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    378</span>             <span class="ansi-green-fg">if</span> norm<span class="ansi-blue-fg">.</span>keywords<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;do_y&#39;</span><span class="ansi-blue-fg">,</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> raw_pred <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>data<span class="ansi-blue-fg">.</span>denorm<span class="ansi-blue-fg">(</span>raw_pred<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    379</span>         ds <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>data<span class="ansi-blue-fg">.</span>single_ds
<span class="ansi-green-fg">--&gt; 380</span><span class="ansi-red-fg">         </span>pred <span class="ansi-blue-fg">=</span> ds<span class="ansi-blue-fg">.</span>y<span class="ansi-blue-fg">.</span>analyze_pred<span class="ansi-blue-fg">(</span>raw_pred<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    381</span>         x <span class="ansi-blue-fg">=</span> ds<span class="ansi-blue-fg">.</span>x<span class="ansi-blue-fg">.</span>reconstruct<span class="ansi-blue-fg">(</span>grab_idx<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    382</span>         y <span class="ansi-blue-fg">=</span> ds<span class="ansi-blue-fg">.</span>y<span class="ansi-blue-fg">.</span>reconstruct<span class="ansi-blue-fg">(</span>pred<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> has_arg<span class="ansi-blue-fg">(</span>ds<span class="ansi-blue-fg">.</span>y<span class="ansi-blue-fg">.</span>reconstruct<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;x&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> ds<span class="ansi-blue-fg">.</span>y<span class="ansi-blue-fg">.</span>reconstruct<span class="ansi-blue-fg">(</span>pred<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">TypeError</span>: analyze_pred() got an unexpected keyword argument &#39;n_words&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">rdkit</span>
<span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem.Draw</span> <span class="kn">import</span> <span class="n">IPythonConsole</span>
<span class="k">def</span> <span class="nf">getMolecule</span><span class="p">(</span><span class="n">startt</span><span class="p">):</span>
    <span class="c1">#p = learn.beam_search(startt, n_words=20, beam_sz=200)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="s1">&#39;CC&#39;</span><span class="p">,</span> <span class="n">n_words</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:</span><span class="n">p</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">BOS</span><span class="p">)]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">getMolecule</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-229-c0c8e41e5849&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>getMolecule<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;O&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-228-b8a27e00a35a&gt;</span> in <span class="ansi-cyan-fg">getMolecule</span><span class="ansi-blue-fg">(startt)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span class="ansi-green-fg">def</span> getMolecule<span class="ansi-blue-fg">(</span>startt<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>     <span class="ansi-red-fg">#p = learn.beam_search(startt, n_words=20, beam_sz=200)</span>
<span class="ansi-green-fg">----&gt; 6</span><span class="ansi-red-fg">     </span>p <span class="ansi-blue-fg">=</span> learn<span class="ansi-blue-fg">.</span>predict<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;CC&#39;</span><span class="ansi-blue-fg">,</span> n_words<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">20</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span>     p <span class="ansi-blue-fg">=</span> p<span class="ansi-blue-fg">.</span>replace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39; &#39;</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span>     p <span class="ansi-blue-fg">=</span> p<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span>p<span class="ansi-blue-fg">.</span>index<span class="ansi-blue-fg">(</span>BOS<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">~/miniconda3/envs/schnetpack+fastai/lib/python3.6/site-packages/fastai/basic_train.py</span> in <span class="ansi-cyan-fg">predict</span><span class="ansi-blue-fg">(self, item, return_x, batch_first, with_dropout, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    378</span>             <span class="ansi-green-fg">if</span> norm<span class="ansi-blue-fg">.</span>keywords<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;do_y&#39;</span><span class="ansi-blue-fg">,</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> raw_pred <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>data<span class="ansi-blue-fg">.</span>denorm<span class="ansi-blue-fg">(</span>raw_pred<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    379</span>         ds <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>data<span class="ansi-blue-fg">.</span>single_ds
<span class="ansi-green-fg">--&gt; 380</span><span class="ansi-red-fg">         </span>pred <span class="ansi-blue-fg">=</span> ds<span class="ansi-blue-fg">.</span>y<span class="ansi-blue-fg">.</span>analyze_pred<span class="ansi-blue-fg">(</span>raw_pred<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    381</span>         x <span class="ansi-blue-fg">=</span> ds<span class="ansi-blue-fg">.</span>x<span class="ansi-blue-fg">.</span>reconstruct<span class="ansi-blue-fg">(</span>grab_idx<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    382</span>         y <span class="ansi-blue-fg">=</span> ds<span class="ansi-blue-fg">.</span>y<span class="ansi-blue-fg">.</span>reconstruct<span class="ansi-blue-fg">(</span>pred<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> has_arg<span class="ansi-blue-fg">(</span>ds<span class="ansi-blue-fg">.</span>y<span class="ansi-blue-fg">.</span>reconstruct<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;x&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> ds<span class="ansi-blue-fg">.</span>y<span class="ansi-blue-fg">.</span>reconstruct<span class="ansi-blue-fg">(</span>pred<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">TypeError</span>: analyze_pred() got an unexpected keyword argument &#39;n_words&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interp</span> <span class="o">=</span> <span class="n">TextClassificationInterpretation</span><span class="o">.</span><span class="n">from_learner</span><span class="p">(</span><span class="n">learn</span><span class="p">)</span>
<span class="c1">#https://forums.fast.ai/t/difference-in-result-during-inference-when-using-learn-get-preds-or-learn-predict/33740/3</span>
<span class="c1">#learn.get_preds(DatasetType.Valid)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>learn.predict<span class="o">??</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>text</th>
      <th>target</th>
      <th>pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>xxbos C C 1 ( O ) C 2 C O C O C 2 1 xxbos O = C</td>
      <td>C 1 2 C C 3 C C 1 O C 3 2 xxbos C # C C ( O</td>
      <td>C 1 C C C C C C 1 C xxbos 3 xxbos xxbos C C C C 1 C</td>
    </tr>
    <tr>
      <td>c 1 c c n ( C ) c 1 C xxbos C C C 1 N C ( C</td>
      <td>) C 1 N O xxbos N # C C 1 = C C C ( = O ) C</td>
      <td>) C 1 C C xxbos C # C C 1 C C C C ( C O ) C</td>
    </tr>
    <tr>
      <td># N xxbos C # C C ( C ) C ( = O ) N ( C ) C</td>
      <td>xxbos O = C C c 1 n c c n n 1 xxbos C O c 1 c c</td>
      <td>1 C = C C 1 1 c c c ( c 1 xxbos C C C 1 c c</td>
    </tr>
    <tr>
      <td>O 2 xxbos C # C C 1 = C C C ( = O ) C C 1 xxbos</td>
      <td>C C 1 C 2 C 3 C ( = O ) N 1 C 3 2 C xxbos C</td>
      <td>C C 1 C C C C C C C O ) C 1 xxbos 2 xxbos xxbos xxbos C</td>
    </tr>
    <tr>
      <td>C ( = O ) O xxbos C O C 1 ( C ) C 2 C C 1 C</td>
      <td>= O xxbos C C 1 ( O ) C 2 C = C C 1 N 2 xxbos C</td>
      <td>2 xxbos O xxbos C C 1 C C ) C C C C O C 1 xxbos C xxbos</td>
    </tr>
    <tr>
      <td>C ) c 1 N xxbos O = C 1 C C C 2 ( O ) C C 2</td>
      <td>2 C 1 xxbos N C 1 C O c 2 n n o c 2 1 xxbos C C</td>
      <td>1 xxbos C xxbos C # 1 C C C 1 c c c 1 1 1 xxbos C C</td>
    </tr>
    <tr>
      <td>C 2 C 3 C C ( O 3 ) C 2 1 xxbos C # C c 1 o</td>
      <td>n n c 1 C xxbos C # C C 1 O C ( C O ) C 1 C</td>
      <td>c c c 1 C C C C C C 1 C C C C ) ) C 1 xxbos</td>
    </tr>
    <tr>
      <td>C # C C ( C C ) C 1 C C 1 C xxbos C C 1 O C</td>
      <td>2 C C C C 1 C 2 xxbos C C 1 2 C C ( O ) ( C</td>
      <td>C C C 1 1 1 C C xxbos C C 1 C C C C C ) C C</td>
    </tr>
    <tr>
      <td>) C 1 xxbos C # C C 1 2 O C 3 C C 1 C C 3 2</td>
      <td>xxbos C C ( O ) C 1 ( C = O ) C C 1 C xxbos C O</td>
      <td>xxbos C C 1 C ) C ( C C ) O ) C 1 1 xxbos C C C</td>
    </tr>
    <tr>
      <td>1 C C 1 xxbos O c 1 c n 2 c ( n 1 ) N C C 2</td>
      <td>xxbos C C 1 = C 2 C ( C ) C C 2 C C 1 xxbos C #</td>
      <td>xxbos C C 1 C C C C C C ) C 1 1 xxbos C 1 xxbos C C</td>
    </tr>
    <tr>
      <td>C C 1 C = C C C 2 O C 1 2 xxbos C C ( C ) C</td>
      <td>1 C C ( = O ) C 1 C xxbos C C 1 C ( = O ) C</td>
      <td>( C C 2 = O ) C 1 xxbos C C C 1 C C C O ) C</td>
    </tr>
    <tr>
      <td>O xxbos C C 1 = C C 2 C ( C ) C 1 C 2 O xxbos C</td>
      <td>1 C C 2 3 C C C 4 C 2 C 1 C 4 3 xxbos C C C</td>
      <td>C C C ( C C C C 1 C C 3 3 C 3 xxbos xxbos C C 1</td>
    </tr>
    <tr>
      <td>O C 1 C 2 ( O ) C 3 C C 2 C 1 3 O xxbos C #</td>
      <td>C C 1 O C C C = C 1 C xxbos C C 1 2 C O C (</td>
      <td>C C 1 C C C 1 1 O C C C C C 1 C C C C 1</td>
    </tr>
    <tr>
      <td>= O xxbos C # C C 1 C C 2 C O C 1 O 2 xxbos O =</td>
      <td>C 1 C c 2 n c [ n H ] c 2 C 1 xxbos C C C (</td>
      <td>C C C C 1 c c c n H ] c 1 1 1 xxbos C C 1 1</td>
    </tr>
    <tr>
      <td>C 1 C 2 3 xxbos C O C 1 ( C C = O ) C C C 1</td>
      <td>xxbos C C 1 C 2 N C ( C ( = O ) O ) C 1 2 xxbos</td>
      <td>xxbos C C 1 C C C C 1 C ) ) O ) C xxbos C 1 xxbos xxbos</td>
    </tr>
    <tr>
      <td>C C 1 C C 2 ( O ) C C 1 C 2 xxbos C # C C (</td>
      <td>= O ) N 1 C C C 1 = O xxbos O C C 1 2 C C 1</td>
      <td>C O ) C C C C 1 1 xxbos O xxbos C = 1 1 C C C C</td>
    </tr>
    <tr>
      <td>C C 1 2 O xxbos C # C C 1 ( O ) C O C ( C )</td>
      <td>C 1 xxbos C C 1 C 2 N C ( = O ) C C 1 2 O xxbos</td>
      <td>C 1 xxbos C C 1 C C C C 1 C O ) C 1 1 xxbos xxbos xxbos</td>
    </tr>
    <tr>
      <td>C C N c 1 n c n [ n H ] 1 xxbos C N C 1 ( C</td>
      <td>( N ) C # N ) C C 1 xxbos C C C C 1 C 2 C C</td>
      <td>) ) ) C C N ) C 1 1 xxbos C C 1 1 ( C C C C</td>
    </tr>
    <tr>
      <td>= O xxbos O = C C 1 N C ( = O ) N 2 C C 1 2</td>
      <td>xxbos C C ( C ) C 1 = N C C ( = O ) N 1 xxbos O</td>
      <td>xxbos C C 1 C ) C ( C C C C 2 = O ) C xxbos xxbos C</td>
    </tr>
    <tr>
      <td>) N C xxbos C C C C ( C ) O C C # N xxbos O C 1</td>
      <td>2 C C ( C 1 ) C C 2 1 C C 1 xxbos N # C C 1</td>
      <td>C C C C C ) C C 2 1 xxbos xxbos C 2 xxbos C # C C 1</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">ds_type</span><span class="o">=</span><span class="n">DatasetType</span><span class="o">.</span><span class="n">Valid</span><span class="p">)</span>
<span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[-1.4395, 30.5148],
        [ 0.9379, 35.2938],
        [-1.2837, 29.9485],
        ...,
        [ 2.7527, 39.2050],
        [ 0.0696, 14.2980],
        [ 0.2022, 31.7748]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">preds</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x7f3cf7190518&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">preds</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x7f3cf02d4cc0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

